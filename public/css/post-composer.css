:root{
  --composer-backdrop:#050812cc;
  --composer-panel:rgba(15,18,35,.78);
  --composer-panel-day:rgba(255,255,255,.9);
  --composer-border:rgba(255,255,255,.22);
  --composer-border-day:rgba(24,38,70,.12);
  --composer-muted:rgba(240,245,255,.72);
}

.profile-view.theme-day,
.feed.theme-day,
.composer-backdrop.is-day{
  /* Use a light translucent backdrop for day theme so the composer doesn't look dark */
  --composer-backdrop: rgba(255,255,255,.6);
}

.composer-backdrop{
  position:fixed;
  inset:0;
  background:var(--composer-backdrop);
  backdrop-filter:blur(24px);
  -webkit-backdrop-filter:blur(24px);
  display:none;
  align-items:center;
  justify-content:center;
  padding:24px;
  opacity:0;
  pointer-events:none;
  transition:opacity .3s ease;
  z-index:999;
}

.composer-backdrop.is-visible{
  display:flex;
  opacity:1;
  pointer-events:auto;
}

.composer-backdrop.is-day{
  color:#1f2937;
}

.composer-backdrop.is-day .composer-modal{
  background:var(--composer-panel-day);
  border:1px solid var(--composer-border-day);
  color:#1f2937;
}

.composer-modal.is-day{
  background:var(--composer-panel-day);
  border:1px solid var(--composer-border-day);
  color:#1f2937;
}

/* Day-specific visual refinements to avoid dark patches on the left panel */
.composer-modal.is-day{
  /* soften the heavy dark shadow used in night theme */
  box-shadow: 0 20px 40px rgba(24,38,70,.08);
}

.composer-backdrop.is-day .composer-preview::after{
  /* use a subtle cool border over the light preview area */
  border:1px solid rgba(24,38,70,.06);
}

.composer-modal.is-day .composer-actions{
  background:var(--composer-panel-day);
  border-top:1px solid var(--composer-border-day);
}

.composer-backdrop.is-day .composer-preview{
  background:rgba(240,244,255,.82);
}

.composer-backdrop.is-day .composer-upload{
  background:linear-gradient(160deg,rgba(240,244,255,.92),rgba(240,244,255,.86));
  color:#1f2937;
}

.composer-modal{
  width:min(960px,100%);
  /* Usa toda la altura visible para garantizar scroll interno en el panel */
  height:90vh;
  border-radius:32px;
  overflow:hidden;
  display:grid;
  grid-template-columns: minmax(320px, 1.1fr) minmax(260px, 0.9fr);
  background:var(--composer-panel);
  border:1px solid var(--composer-border);
  box-shadow:0 40px 90px rgba(0,0,0,.36);
  transform:translateY(18px) scale(.96);
  opacity:0;
  transition:transform .3s ease, opacity .3s ease;
}

.composer-backdrop.is-visible .composer-modal{
  transform:translateY(0) scale(1);
  opacity:1;
}

.feed.theme-day .composer-modal,
.profile-view.theme-day .composer-modal{
  background:var(--composer-panel-day);
  border:1px solid var(--composer-border-day);
  color:#1f2937;
}

.composer-preview{
  position:relative;
  background:rgba(0,0,0,.4);
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
  /* Asegura que el contenedor de la imagen llene la altura del modal */
  height:100%;
  /* Permite que el item dentro del grid pueda encoger y habilitar scroll del panel */
  min-height:0;
}

.composer-preview::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  border:1px solid rgba(255,255,255,.12);
  border-radius:inherit;
}

.composer-preview img{
  max-width:100%;
  max-height:100%;
  object-fit:contain;
  transition:filter .2s ease;
}

.composer-upload{
  position:absolute;
  inset:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:18px;
  color:rgba(255,255,255,.84);
  text-align:center;
  padding:24px;
  pointer-events:auto;
  background:linear-gradient(160deg,rgba(15,18,35,.9),rgba(15,18,35,.82));
}

.feed.theme-day .composer-upload,
.profile-view.theme-day .composer-upload{
  background:linear-gradient(160deg,rgba(240,244,255,.92),rgba(240,244,255,.86));
  color:#1f2937;
}

.composer-upload input[type="file"]{
  display:none;
}

.composer-upload button{
  background:linear-gradient(135deg,#4ea8ff,#675dff);
  border:none;
  color:#fff;
  border-radius:999px;
  padding:12px 22px;
  font-weight:600;
  cursor:pointer;
  transition:transform .2s ease, box-shadow .2s ease;
}

.composer-upload button:hover{
  transform:translateY(-2px);
  box-shadow:0 18px 38px rgba(0,0,0,.35);
}

.publication-viewer{
  z-index:1000;
}

.publication-viewer__modal{
  max-width:920px;
}

.publication-viewer__media{
  background:rgba(0,0,0,.55);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:12px;
}

.publication-viewer__media img{
  max-width:100%;
  max-height:100%;
  object-fit:contain;
  border-radius:18px;
}

.publication-viewer__panel{
  display:flex;
  flex-direction:column;
  gap:18px;
  padding:28px;
  color:inherit;
}

.publication-viewer__head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:16px;
}

.publication-viewer__owner{
  display:flex;
  align-items:center;
  gap:12px;
}

.publication-viewer__owner-avatar{
  width:48px;
  height:48px;
  border-radius:14px;
  object-fit:cover;
}

.publication-viewer__owner-meta{
  display:flex;
  flex-direction:column;
  gap:4px;
}

.publication-viewer__owner-name{
  margin:0;
  font-size:18px;
  font-weight:600;
}

/* Viewer top-right controls (more/close) */
.publication-viewer__controls{ display:flex; gap:8px; align-items:center; position:relative; }
.publication-viewer__more{
  background:transparent; border:none; color:inherit; cursor:pointer;
  width:36px; height:36px; display:grid; place-items:center; border-radius:10px;
  opacity:.85; margin-top:-1px; /* ajuste óptico para alinear con la X */
  transition:opacity .2s ease, transform .18s ease, background-color .18s ease;
}
.publication-viewer__more:hover{ opacity:1; transform: translateY(-1px); background:rgba(255,255,255,.06); }
.publication-viewer.is-day .publication-viewer__more:hover{ background:rgba(24,36,68,.06); }
.publication-viewer__more .icon{ width:20px; height:20px; }

/* Context menu for viewer */
.publication-viewer__menu{
  min-width: 170px;
  background: rgba(15,18,35,.96);
  border: 1px solid rgba(255,255,255,.14);
  border-radius: 12px;
  box-shadow: 0 12px 28px rgba(0,0,0,.25);
  overflow: hidden;
}
.publication-viewer.is-day .publication-viewer__menu{
  background: rgba(255,255,255,.98);
  border: 1px solid rgba(24,38,70,.12);
  box-shadow: 0 12px 28px rgba(24,38,70,.08);
}
.publication-viewer__menu-item{
  display:grid; grid-template-columns: 20px 1fr; align-items:center; gap:10px;
  width:100%; padding:10px 14px; border:0; background:transparent; text-align:left; cursor:pointer; color:inherit; font-weight:600;
}
.publication-viewer__menu-item .icon{ width:18px; height:18px; }
.publication-viewer__menu-item[data-action="delete"]{ color:#f05252; }
.publication-viewer.is-day .publication-viewer__menu-item[data-action="delete"]{ color:#c53030; }
.publication-viewer__menu-item:hover{ background: rgba(255,255,255,.06); }
.publication-viewer.is-day .publication-viewer__menu-item:hover{ background: rgba(24,36,68,.06); }

.publication-viewer__owner-date{
  font-size:12px;
  opacity:.7;
}

.publication-viewer__caption{
  margin:0;
  font-size:15px;
  line-height:1.5;
}

.publication-viewer__actions{
  display:flex;
  flex-wrap:wrap;
  align-items:center;
  gap:12px;
}

.publication-viewer__btn{
  border:0;
  border-radius:999px;
  padding:8px 18px;
  font-weight:600;
  cursor:pointer;
  background:rgba(255,255,255,.18);
  color:inherit;
  transition:background .2s ease, transform .2s ease;
}

.publication-viewer__btn:hover{
  transform:translateY(-1px);
  background:rgba(255,255,255,.28);
}

.publication-viewer__btn--like.is-active{
  background:rgba(255,99,132,.52);
  color:#fff;
}

.publication-viewer__btn--save{
  background:rgba(78,168,255,.26);
}

.publication-viewer__btn--save.is-active{
  background:rgba(78,168,255,.38);
  color:#fff;
}

.publication-viewer__likes{
  font-weight:600;
  opacity:.8;
}

.publication-viewer__tags{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
}

.publication-viewer__tag{
  padding:6px 14px;
  border-radius:999px;
  background:rgba(255,255,255,.18);
  font-size:12px;
  letter-spacing:.16em;
  text-transform:uppercase;
}

.publication-viewer__tag.is-empty{
  opacity:.6;
}

.publication-viewer__comments{
  display:flex;
  flex-direction:column;
  gap:14px;
}

.publication-viewer__comments-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  font-size:12px;
  letter-spacing:.18em;
  text-transform:uppercase;
  opacity:.72;
}

.publication-viewer__comments-list{
  display:flex;
  flex-direction:column;
  gap:12px;
  max-height:240px;
  overflow-y:auto;
  padding-right:6px;
}

.publication-viewer__comments-empty{
  margin:0;
  font-size:13px;
  opacity:.7;
}

.publication-comment{
  display:flex;
  align-items:flex-start;
  gap:12px;
}

.publication-comment__avatar img{
  width:42px;
  height:42px;
  border-radius:14px;
  object-fit:cover;
}

.publication-comment__body{
  flex:1;
  display:flex;
  flex-direction:column;
  gap:6px;
  background:rgba(0,0,0,.22);
  border-radius:16px;
  padding:12px 16px;
}

.publication-comment__header{
  display:flex;
  align-items:center;
  gap:10px;
  font-weight:600;
  font-size:13px;
}

.publication-comment__badge{
  border-radius:999px;
  padding:2px 8px;
  background:rgba(78,168,255,.3);
  font-size:11px;
  letter-spacing:.12em;
}

.publication-comment__time{
  margin-left:auto;
  font-size:11px;
  opacity:.6;
}

.publication-comment__text{
  margin:0;
  font-size:14px;
  line-height:1.5;
}

.publication-viewer__form{
  display:flex;
  align-items:center;
  gap:10px;
}

.publication-viewer__input{
  flex:1;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.24);
  background:rgba(0,0,0,.28);
  color:inherit;
  padding:10px 16px;
  font-size:14px;
  transition:border-color .2s ease, background .2s ease;
}

.publication-viewer__input:focus{
  outline:none;
  border-color:rgba(78,168,255,.45);
  background:rgba(0,0,0,.34);
}

.publication-viewer__form button{
  border:0;
  border-radius:999px;
  padding:10px 18px;
  font-weight:600;
  cursor:pointer;
  background:rgba(78,168,255,.32);
  color:#fff;
  transition:background .2s ease, transform .2s ease;
}

.publication-viewer__form button:hover{
  transform:translateY(-1px);
  background:rgba(78,168,255,.4);
}

.publication-viewer__form.is-busy button{
  opacity:.6;
  pointer-events:none;
}

.publication-viewer.is-day .publication-viewer__media{
  background:rgba(240,244,255,.86);
}

.publication-viewer.is-day .publication-viewer__panel{
  color:#1f2937;
}

.publication-viewer.is-day .publication-viewer__btn{
  background:rgba(24,36,68,.08);
  color:#1f2937;
}

.publication-viewer.is-day .publication-viewer__btn:hover{
  background:rgba(24,36,68,.12);
}

.publication-viewer.is-day .publication-viewer__btn--like.is-active{
  background:rgba(255,110,150,.36);
  color:#1f2937;
}

.publication-viewer.is-day .publication-viewer__btn--save{
  background:rgba(110,170,255,.24);
}

.publication-viewer.is-day .publication-viewer__btn--save.is-active{
  background:rgba(110,170,255,.32);
  color:#1f2937;
}

.publication-viewer.is-day .publication-viewer__tag{
  background:rgba(24,36,68,.08);
}

.publication-viewer.is-day .publication-comment__body{
  background:rgba(24,36,68,.08);
}

.publication-viewer.is-day .publication-comment__badge{
  background:rgba(78,168,255,.2);
  color:#1f2937;
}

.publication-viewer.is-day .publication-viewer__input{
  background:rgba(24,36,68,.08);
  border-color:rgba(24,36,68,.12);
  color:#1f2937;
}

.publication-viewer.is-day .publication-viewer__input:focus{
  background:rgba(24,36,68,.12);
}

.publication-viewer.is-day .publication-viewer__form button{
  background:rgba(78,168,255,.28);
  color:#1f2937;
}

.composer-panel{
  display:flex;
  flex-direction:column;
  padding:26px 26px 24px;
  gap:24px;
  /* Habilita scroll vertical cuando el contenido se desborda */
  overflow-y:auto;
  height:100%;
  min-height:0; /* necesario dentro de CSS grid para que el scroll funcione */
  padding-bottom:16px; /* espacio de respiración inferior */
  scroll-padding-bottom:96px; /* evita que el último contenido quede oculto tras acciones pegajosas */
}

.composer-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:16px;
}

.composer-head h2{
  font-size:20px;
  margin:0;
  letter-spacing:.18em;
  text-transform:uppercase;
}

.composer-close{
  background:transparent;
  border:none;
  color:inherit;
  font-size:26px;
  cursor:pointer;
  opacity:.7;
  transition:opacity .2s ease, transform .2s ease;
}

.composer-close:hover{
  opacity:1;
  transform:scale(1.1);
}

/* Pasos del compositor */
.composer-step{ display:none; }
.composer-step.is-active{ display:block; }


.composer-filters{
  display:flex;
  gap:12px;
  overflow-x:auto;
  padding-bottom:4px;
  scrollbar-width:none;
}
.composer-filters::-webkit-scrollbar{ display:none; }

.composer-filter{
  min-width:82px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(0,0,0,.18);
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:8px;
  padding:12px 10px;
  cursor:pointer;
  transition:border-color .2s ease, transform .2s ease, background .2s ease;
}

.composer-filter.is-active{
  border-color:var(--accent);
  box-shadow:0 10px 24px rgba(78,168,255,.28);
}

.feed.theme-day .composer-filter,
.profile-view.theme-day .composer-filter{
  background:rgba(240,244,255,.78);
  border-color:rgba(24,36,68,.14);
}

.composer-filter__preview{
  width:60px;
  height:60px;
  border-radius:14px;
  overflow:hidden;
  background:rgba(0,0,0,.28);
  display:grid;
  place-items:center;
}

.composer-filter__preview img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}

.composer-filter span{
  font-size:11px;
  letter-spacing:.18em;
  text-transform:uppercase;
}

/* Mejor legibilidad en modo claro para los nombres de filtros */
.feed.theme-day .composer-filter span,
.profile-view.theme-day .composer-filter span{
  color:#1f2937;
  opacity:.92;
}

.composer-sliders{
  display:flex;
  flex-direction:column;
  gap:16px;
}

.composer-slider{
  display:flex;
  flex-direction:column;
  gap:6px;
}

.composer-slider label{
  font-size:12px;
  letter-spacing:.16em;
  text-transform:uppercase;
  opacity:.8;
}

.composer-slider input[type="range"]{
  width:100%;
  accent-color:#4ea8ff;
}

.composer-form{
  display:flex;
  flex-direction:column;
  gap:16px;
}

.composer-form textarea{
  min-height:96px;
  resize:vertical;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.22);
  background:rgba(0,0,0,.32);
  padding:14px 16px;
  color:inherit;
  font-family:inherit;
  font-size:14px;
}

.feed.theme-day .composer-form textarea,
.profile-view.theme-day .composer-form textarea{
  background:rgba(255,255,255,.86);
  border-color:rgba(24,38,70,.12);
  color:#1f2937;
}

.composer-tags{
  display:flex;
  flex-direction:column;
  gap:10px;
}

.composer-tags input{
  border-radius:999px;
  border:1px solid rgba(255,255,255,.22);
  background:rgba(0,0,0,.26);
  padding:10px 14px;
  color:inherit;
}

.composer-tags span{
  display:inline-flex;
  align-items:center;
  gap:6px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.24);
  background:rgba(0,0,0,.22);
  padding:6px 12px;
  font-size:12px;
  letter-spacing:.12em;
  text-transform:uppercase;
}

.feed.theme-day .composer-tags input,
.profile-view.theme-day .composer-tags input{
  background:rgba(255,255,255,.86);
  border-color:rgba(24,38,70,.12);
  color:#1f2937;
}

.feed.theme-day .composer-tags span,
.profile-view.theme-day .composer-tags span{
  background:rgba(240,244,255,.78);
  border-color:rgba(24,38,70,.14);
  color:#1f2937;
}


.composer-actions{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  /* Fija los botones visibles mientras el panel hace scroll */
  position:sticky;
  bottom:0;
  margin-top:12px;
  padding-top:10px;
  padding-bottom:10px;
  background:var(--composer-panel);
  border-top:1px solid var(--composer-border);
  z-index:2;
}

.feed.theme-day .composer-actions,
.profile-view.theme-day .composer-actions{
  background:var(--composer-panel-day);
  border-top:1px solid var(--composer-border-day);
}

.composer-actions select{
  border-radius:12px;
  padding:8px 14px;
  background:rgba(0,0,0,.26);
  border:1px solid rgba(255,255,255,.18);
  color:inherit;
}

.feed.theme-day .composer-actions select,
.profile-view.theme-day .composer-actions select{
  background:rgba(255,255,255,.82);
  border-color:rgba(24,38,70,.12);
  color:#1f2937;
}

.composer-actions button{
  border-radius:999px;
  padding:10px 20px;
  border:none;
  font-weight:600;
  cursor:pointer;
  transition:transform .2s ease, box-shadow .2s ease;
}

.composer-actions .btn-cancel{
  background:rgba(0,0,0,.28);
  border:1px solid rgba(255,255,255,.18);
  color:inherit;
}
.composer-actions .btn-cancel:hover{ transform:translateY(-1px); }

.composer-actions .btn-submit,
.composer-actions .btn-next{
  background:linear-gradient(135deg,#4ea8ff,#7651ff);
  color:#fff;
}
.composer-actions .btn-submit:hover,
.composer-actions .btn-next:hover{
  transform:translateY(-1px);
  box-shadow:0 18px 40px rgba(0,0,0,.32);
}

.composer-hidden{
  display:none !important;
}

.composer-error{
  background:rgba(255,115,140,.22);
  border:1px solid rgba(255,115,140,.42);
  color:#fff;
  border-radius:16px;
  padding:10px 14px;
  font-size:13px;
}

.feed.theme-day .composer-error,
.profile-view.theme-day .composer-error{
  background:rgba(255,115,140,.18);
  color:#b4233c;
  border-color:rgba(255,115,140,.28);
}

/* ===== Confirm dialog (reutiliza variables del compositor) ===== */
.confirm-backdrop{ z-index: 1100; }
.confirm-modal{
  width: min(420px, 96vw);
  border-radius: 22px;
  background: var(--composer-panel);
  border: 1px solid var(--composer-border);
  box-shadow: 0 24px 64px rgba(0,0,0,.35);
  padding: 22px 22px 18px;
  color: #fff;
  transform: translateY(18px) scale(.98);
  opacity: 0;
  transition: transform .25s ease, opacity .25s ease;
}
.confirm-backdrop.is-visible .confirm-modal{ transform: translateY(0) scale(1); opacity: 1; }
.confirm-backdrop.is-day .confirm-modal{
  background: var(--composer-panel-day);
  border: 1px solid var(--composer-border-day);
  color: #1f2937;
  box-shadow: 0 20px 40px rgba(24,38,70,.08);
}
.confirm-icon{ font-size: 28px; line-height: 1; }
.confirm-title{ margin: 8px 0 6px; font-size: 18px; }
.confirm-message{ margin: 0 0 14px; font-size: 14px; opacity: .88; }
.confirm-actions{ display: flex; justify-content: flex-end; gap: 10px; }
.confirm-actions .btn-cancel,
.confirm-actions .btn-confirm{
  border: 0;
  border-radius: 999px;
  padding: 10px 16px;
  font-weight: 600;
  cursor: pointer;
}
.confirm-actions .btn-cancel{
  background: rgba(255,255,255,.16);
  color: inherit;
}
.confirm-actions .btn-confirm{ background: linear-gradient(135deg,#ff6b6b,#f43f5e); color: #fff; }
.confirm-actions .btn-confirm.is-danger{ background: linear-gradient(135deg,#ff6b6b,#f43f5e); }
.confirm-backdrop.is-day .confirm-actions .btn-cancel{ background: rgba(24,36,68,.08); color: #1f2937; }
.confirm-backdrop.is-day .confirm-actions .btn-confirm{ color: #fff; }
